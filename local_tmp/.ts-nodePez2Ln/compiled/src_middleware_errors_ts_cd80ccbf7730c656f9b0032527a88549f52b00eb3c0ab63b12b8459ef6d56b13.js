"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.errorHandler = errorHandler;
const errors_1 = require("../utils/errors");
function errorHandler(err, req, res, _next) {
    const context = {
        method: req.method,
        url: req.url,
        userAgent: req.get('User-Agent'),
        ip: req.ip,
    };
    const httpError = (0, errors_1.logError)(err, context);
    res.status(httpError.statusCode).json((0, errors_1.createErrorResponse)(httpError));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL3Vzci9zcmMvYXBwL3NyYy9taWRkbGV3YXJlL2Vycm9ycy50cyIsInNvdXJjZXMiOlsiL3Vzci9zcmMvYXBwL3NyYy9taWRkbGV3YXJlL2Vycm9ycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQWFBLG9DQVdDO0FBdEJELDRDQUFnRTtBQVdoRSxTQUFnQixZQUFZLENBQUMsR0FBWSxFQUFFLEdBQVksRUFBRSxHQUFhLEVBQUUsS0FBbUI7SUFDekYsTUFBTSxPQUFPLEdBQUc7UUFDZCxNQUFNLEVBQUUsR0FBRyxDQUFDLE1BQU07UUFDbEIsR0FBRyxFQUFFLEdBQUcsQ0FBQyxHQUFHO1FBQ1osU0FBUyxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDO1FBQ2hDLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFBRTtLQUNYLENBQUM7SUFFRixNQUFNLFNBQVMsR0FBRyxJQUFBLGlCQUFRLEVBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBRXpDLEdBQUcsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFBLDRCQUFtQixFQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7QUFDeEUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRGdW5jdGlvbiwgUmVxdWVzdCwgUmVzcG9uc2UgfSBmcm9tICdleHByZXNzJztcblxuaW1wb3J0IHsgY3JlYXRlRXJyb3JSZXNwb25zZSwgbG9nRXJyb3IgfSBmcm9tICcuLi91dGlscy9lcnJvcnMnO1xuXG4vKipcbiAqIEV4cHJlc3MgZXJyb3IgaGFuZGxpbmcgbWlkZGxld2FyZSB0aGF0IG5vcm1hbGl6ZXMsIGxvZ3MsIGFuZCByZXNwb25kcyB0byBlcnJvcnMuXG4gKiBGaW5hbCBlcnJvciBoYW5kbGVyIGluIHRoZSBtaWRkbGV3YXJlIGNoYWluIHRoYXQgZW5zdXJlcyBjb25zaXN0ZW50IGVycm9yIHJlc3BvbnNlcy5cbiAqXG4gKiBAcGFyYW0gZXJyIC0gVGhlIGVycm9yIHRoYXQgb2NjdXJyZWQgZHVyaW5nIHJlcXVlc3QgcHJvY2Vzc2luZ1xuICogQHBhcmFtIHJlcSAtIEV4cHJlc3MgcmVxdWVzdCBvYmplY3RcbiAqIEBwYXJhbSByZXMgLSBFeHByZXNzIHJlc3BvbnNlIG9iamVjdFxuICogQHBhcmFtIF9uZXh0IC0gRXhwcmVzcyBuZXh0IGZ1bmN0aW9uICh1bnVzZWQgYXMgdGhpcyBpcyB0aGUgZmluYWwgaGFuZGxlcilcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVycm9ySGFuZGxlcihlcnI6IHVua25vd24sIHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgX25leHQ6IE5leHRGdW5jdGlvbik6IHZvaWQge1xuICBjb25zdCBjb250ZXh0ID0ge1xuICAgIG1ldGhvZDogcmVxLm1ldGhvZCxcbiAgICB1cmw6IHJlcS51cmwsXG4gICAgdXNlckFnZW50OiByZXEuZ2V0KCdVc2VyLUFnZW50JyksXG4gICAgaXA6IHJlcS5pcCxcbiAgfTtcblxuICBjb25zdCBodHRwRXJyb3IgPSBsb2dFcnJvcihlcnIsIGNvbnRleHQpO1xuXG4gIHJlcy5zdGF0dXMoaHR0cEVycm9yLnN0YXR1c0NvZGUpLmpzb24oY3JlYXRlRXJyb3JSZXNwb25zZShodHRwRXJyb3IpKTtcbn1cbiJdfQ==