"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.GatewayTimeoutError = exports.ServiceUnavailableError = exports.InternalServerError = exports.TooManyRequestsError = exports.NotFoundError = exports.ForbiddenError = exports.UnauthorizedError = exports.BadRequestError = exports.HttpError = void 0;
exports.logError = logError;
exports.normalizeError = normalizeError;
exports.createErrorResponse = createErrorResponse;
const logger_1 = require("./logger");
class HttpError extends Error {
    statusCode;
    constructor(message, statusCode = 500, options) {
        super(message, options);
        this.statusCode = statusCode;
        this.name = 'HttpError';
        Error.captureStackTrace(this, this.constructor);
    }
}
exports.HttpError = HttpError;
class BadRequestError extends HttpError {
    constructor(message, options) {
        super(message, 400, options);
        this.name = 'BadRequestError';
    }
}
exports.BadRequestError = BadRequestError;
class UnauthorizedError extends HttpError {
    constructor(message, options) {
        super(message, 401, options);
        this.name = 'UnauthorizedError';
    }
}
exports.UnauthorizedError = UnauthorizedError;
class ForbiddenError extends HttpError {
    constructor(message, options) {
        super(message, 403, options);
        this.name = 'ForbiddenError';
    }
}
exports.ForbiddenError = ForbiddenError;
class NotFoundError extends HttpError {
    constructor(message, options) {
        super(message, 404, options);
        this.name = 'NotFoundError';
    }
}
exports.NotFoundError = NotFoundError;
class TooManyRequestsError extends HttpError {
    constructor(message, options) {
        super(message, 429, options);
        this.name = 'TooManyRequestsError';
    }
}
exports.TooManyRequestsError = TooManyRequestsError;
class InternalServerError extends HttpError {
    constructor(message, options) {
        super(message, 500, options);
        this.name = 'InternalServerError';
    }
}
exports.InternalServerError = InternalServerError;
class ServiceUnavailableError extends HttpError {
    constructor(message, options) {
        super(message, 503, options);
        this.name = 'ServiceUnavailableError';
    }
}
exports.ServiceUnavailableError = ServiceUnavailableError;
class GatewayTimeoutError extends HttpError {
    constructor(message, options) {
        super(message, 504, options);
        this.name = 'GatewayTimeoutError';
    }
}
exports.GatewayTimeoutError = GatewayTimeoutError;
function logError(error, context) {
    const httpError = normalizeError(error);
    const logData = {
        statusCode: httpError.statusCode,
        message: httpError.message,
        stack: httpError.stack,
        cause: httpError.cause
            ? httpError.cause instanceof Error
                ? { message: httpError.cause.message, stack: httpError.cause.stack }
                : String(httpError.cause)
            : undefined,
        ...context,
    };
    if (httpError.statusCode >= 500) {
        logger_1.logger.error(logData, 'System error');
    }
    else {
        logger_1.logger.warn(logData, 'Client error');
    }
    return httpError;
}
function normalizeError(error) {
    if (error instanceof HttpError) {
        return error;
    }
    if (error instanceof Error) {
        return new InternalServerError(error.message || 'Unknown error occurred', {
            cause: error,
        });
    }
    return new InternalServerError('An unknown error occurred');
}
function createErrorResponse(error) {
    return {
        error: {
            message: error.message,
            statusCode: error.statusCode,
        },
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL3Vzci9zcmMvYXBwL3NyYy91dGlscy9lcnJvcnMudHMiLCJzb3VyY2VzIjpbIi91c3Ivc3JjL2FwcC9zcmMvdXRpbHMvZXJyb3JzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQXNGQSw0QkFzQkM7QUFRRCx3Q0FZQztBQUtELGtEQVlDO0FBakpELHFDQUFrQztBQVVsQyxNQUFhLFNBQVUsU0FBUSxLQUFLO0lBQ2xCLFVBQVUsQ0FBUztJQUVuQyxZQUFZLE9BQWUsRUFBRSxhQUFxQixHQUFHLEVBQUUsT0FBNkI7UUFDbEYsS0FBSyxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN4QixJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztRQUM3QixJQUFJLENBQUMsSUFBSSxHQUFHLFdBQVcsQ0FBQztRQUN4QixLQUFLLENBQUMsaUJBQWlCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNsRCxDQUFDO0NBQ0Y7QUFURCw4QkFTQztBQUtELE1BQWEsZUFBZ0IsU0FBUSxTQUFTO0lBQzVDLFlBQVksT0FBZSxFQUFFLE9BQTZCO1FBQ3hELEtBQUssQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQzdCLElBQUksQ0FBQyxJQUFJLEdBQUcsaUJBQWlCLENBQUM7SUFDaEMsQ0FBQztDQUNGO0FBTEQsMENBS0M7QUFFRCxNQUFhLGlCQUFrQixTQUFRLFNBQVM7SUFDOUMsWUFBWSxPQUFlLEVBQUUsT0FBNkI7UUFDeEQsS0FBSyxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDN0IsSUFBSSxDQUFDLElBQUksR0FBRyxtQkFBbUIsQ0FBQztJQUNsQyxDQUFDO0NBQ0Y7QUFMRCw4Q0FLQztBQUVELE1BQWEsY0FBZSxTQUFRLFNBQVM7SUFDM0MsWUFBWSxPQUFlLEVBQUUsT0FBNkI7UUFDeEQsS0FBSyxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUUsT0FBTyxDQUFD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Q2IsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELE9BQU8sSUFBSSxtQkFBbUIsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO0FBQzlELENBQUM7QUFLRCxTQUFnQixtQkFBbUIsQ0FBQyxLQUFnQjtJQU1sRCxPQUFPO1FBQ0wsS0FBSyxFQUFFO1lBQ0wsT0FBTyxFQUFFLEtBQUssQ0FBQyxPQUFPO1lBQ3RCLFVBQVUsRUFBRSxLQUFLLENBQUMsVUFBVTtTQUM3QjtLQUNGLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi9sb2dnZXInO1xuXG4vKipcbiAqIFNpbXBsZSBlcnJvciBoYW5kbGluZyBzeXN0ZW0gZm9yIHRoZSBCcm9hZHdheSBDb3BpbG90IGFwcGxpY2F0aW9uLlxuICogVXNlcyBzdGFuZGFyZCBFcnJvciBvYmplY3RzIHdpdGggSFRUUCBzdGF0dXMgY29kZXMuXG4gKi9cblxuLyoqXG4gKiBFeHRlbmRlZCBFcnJvciBjbGFzcyB0aGF0IGluY2x1ZGVzIEhUVFAgc3RhdHVzIGNvZGUuXG4gKi9cbmV4cG9ydCBjbGFzcyBIdHRwRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIHB1YmxpYyByZWFkb25seSBzdGF0dXNDb2RlOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCBzdGF0dXNDb2RlOiBudW1iZXIgPSA1MDAsIG9wdGlvbnM/OiB7IGNhdXNlPzogdW5rbm93biB9KSB7XG4gICAgc3VwZXIobWVzc2FnZSwgb3B0aW9ucyk7XG4gICAgdGhpcy5zdGF0dXNDb2RlID0gc3RhdHVzQ29kZTtcbiAgICB0aGlzLm5hbWUgPSAnSHR0cEVycm9yJztcbiAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcbiAgfVxufVxuXG4vKipcbiAqIEEgY29sbGVjdGlvbiBvZiBzcGVjaWZpYyBIVFRQIGVycm9yIGNsYXNzZXMgZm9yIGRpZmZlcmVudCBzdGF0dXMgY29kZXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBCYWRSZXF1ZXN0RXJyb3IgZXh0ZW5kcyBIdHRwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIG9wdGlvbnM/OiB7IGNhdXNlPzogdW5rbm93biB9KSB7XG4gICAgc3VwZXIobWVzc2FnZSwgNDAwLCBvcHRpb25zKTtcbiAgICB0aGlzLm5hbWUgPSAnQmFkUmVxdWVzdEVycm9yJztcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgVW5hdXRob3JpemVkRXJyb3IgZXh0ZW5kcyBIdHRwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIG9wdGlvbnM/OiB7IGNhdXNlPzogdW5rbm93biB9KSB7XG4gICAgc3VwZXIobWVzc2FnZSwgNDAxLCBvcHRpb25zKTtcbiAgICB0aGlzLm5hbWUgPSAnVW5hdXRob3JpemVkRXJyb3InO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGb3JiaWRkZW5FcnJvciBleHRlbmRzIEh0dHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZywgb3B0aW9ucz86IHsgY2F1c2U/OiB1bmtub3duIH0pIHtcbiAgICBzdXBlcihtZXNzYWdlLCA0MDMsIG9wdGlvbnMpO1xuICAgIHRoaXMubmFtZSA9ICdGb3JiaWRkZW5FcnJvcic7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIE5vdEZvdW5kRXJyb3IgZXh0ZW5kcyBIdHRwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIG9wdGlvbnM/OiB7IGNhdXNlPzogdW5rbm93biB9KSB7XG4gICAgc3VwZXIobWVzc2FnZSwgNDA0LCBvcHRpb25zKTtcbiAgICB0aGlzLm5hbWUgPSAnTm90Rm91bmRFcnJvcic7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFRvb01hbnlSZXF1ZXN0c0Vycm9yIGV4dGVuZHMgSHR0cEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCBvcHRpb25zPzogeyBjYXVzZT86IHVua25vd24gfSkge1xuICAgIHN1cGVyKG1lc3NhZ2UsIDQyOSwgb3B0aW9ucyk7XG4gICAgdGhpcy5uYW1lID0gJ1Rvb01hbnlSZXF1ZXN0c0Vycm9yJztcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgSW50ZXJuYWxTZXJ2ZXJFcnJvciBleHRlbmRzIEh0dHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZywgb3B0aW9ucz86IHsgY2F1c2U/OiB1bmtub3duIH0pIHtcbiAgICBzdXBlcihtZXNzYWdlLCA1MDAsIG9wdGlvbnMpO1xuICAgIHRoaXMubmFtZSA9ICdJbnRlcm5hbFNlcnZlckVycm9yJztcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU2VydmljZVVuYXZhaWxhYmxlRXJyb3IgZXh0ZW5kcyBIdHRwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIG9wdGlvbnM/OiB7IGNhdXNlPzogdW5rbm93biB9KSB7XG4gICAgc3VwZXIobWVzc2FnZSwgNTAzLCBvcHRpb25zKTtcbiAgICB0aGlzLm5hbWUgPSAnU2VydmljZVVuYXZhaWxhYmxlRXJyb3InO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBHYXRld2F5VGltZW91dEVycm9yIGV4dGVuZHMgSHR0cEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCBvcHRpb25zPzogeyBjYXVzZT86IHVua25vd24gfSkge1xuICAgIHN1cGVyKG1lc3NhZ2UsIDUwNCwgb3B0aW9ucyk7XG4gICAgdGhpcy5uYW1lID0gJ0dhdGV3YXlUaW1lb3V0RXJyb3InO1xuICB9XG59XG5cbi8qKlxuICogTG9ncyBhbiBlcnJvciB3aXRoIGNvbnNpc3RlbnQgZm9ybWF0dGluZywgYXV0b21hdGljYWxseSBub3JtYWxpemluZyB1bmtub3duIGVycm9yIHR5cGVzLlxuICogQHBhcmFtIGVycm9yIFRoZSBlcnJvciB0byBsb2cgKGNhbiBiZSBhbnkgZXJyb3IgdHlwZSwgd2lsbCBiZSBub3JtYWxpemVkIGludGVybmFsbHkpLlxuICogQHBhcmFtIGNvbnRleHQgQWRkaXRpb25hbCBjb250ZXh0IGFib3V0IHdoZXJlIHRoZSBlcnJvciBvY2N1cnJlZC5cbiAqIEByZXR1cm5zIFRoZSBub3JtYWxpemVkIEh0dHBFcnJvciBmb3IgZnVydGhlciB1c2UgaWYgbmVlZGVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9nRXJyb3IoZXJyb3I6IHVua25vd24sIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IEh0dHBFcnJvciB7XG4gIGNvbnN0IGh0dHBFcnJvciA9IG5vcm1hbGl6ZUVycm9yKGVycm9yKTtcblxuICBjb25zdCBsb2dEYXRhID0ge1xuICAgIHN0YXR1c0NvZGU6IGh0dHBFcnJvci5zdGF0dXNDb2RlLFxuICAgIG1lc3NhZ2U6IGh0dHBFcnJvci5tZXNzYWdlLFxuICAgIHN0YWNrOiBodHRwRXJyb3Iuc3RhY2ssXG4gICAgY2F1c2U6IGh0dHBFcnJvci5jYXVzZVxuICAgICAgPyBodHRwRXJyb3IuY2F1c2UgaW5zdGFuY2VvZiBFcnJvclxuICAgICAgICA/IHsgbWVzc2FnZTogaHR0cEVycm9yLmNhdXNlLm1lc3NhZ2UsIHN0YWNrOiBodHRwRXJyb3IuY2F1c2Uuc3RhY2sgfVxuICAgICAgICA6IFN0cmluZyhodHRwRXJyb3IuY2F1c2UpXG4gICAgICA6IHVuZGVmaW5lZCxcbiAgICAuLi5jb250ZXh0LFxuICB9O1xuXG4gIGlmIChodHRwRXJyb3Iuc3RhdHVzQ29kZSA+PSA1MDApIHtcbiAgICBsb2dnZXIuZXJyb3IobG9nRGF0YSwgJ1N5c3RlbSBlcnJvcicpO1xuICB9IGVsc2Uge1xuICAgIGxvZ2dlci53YXJuKGxvZ0RhdGEsICdDbGllbnQgZXJyb3InKTtcbiAgfVxuXG4gIHJldHVybiBodHRwRXJyb3I7XG59XG5cbi8qKlxuICogTm9ybWFsaXplcyBhbiB1bmtub3duIGVycm9yIGludG8gYW4gSHR0cEVycm9yLlxuICogVGhpcyBlbnN1cmVzIHRoYXQgYW55IHRocm93biB2YWx1ZSBpcyBoYW5kbGVkIGNvbnNpc3RlbnRseS5cbiAqIEBwYXJhbSBlcnJvciBUaGUgZXJyb3IgdG8gbm9ybWFsaXplLlxuICogQHJldHVybnMgQW4gSHR0cEVycm9yIGluc3RhbmNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplRXJyb3IoZXJyb3I6IHVua25vd24pOiBIdHRwRXJyb3Ige1xuICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBIdHRwRXJyb3IpIHtcbiAgICByZXR1cm4gZXJyb3I7XG4gIH1cblxuICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgIHJldHVybiBuZXcgSW50ZXJuYWxTZXJ2ZXJFcnJvcihlcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yIG9jY3VycmVkJywge1xuICAgICAgY2F1c2U6IGVycm9yLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIG5ldyBJbnRlcm5hbFNlcnZlckVycm9yKCdBbiB1bmtub3duIGVycm9yIG9jY3VycmVkJyk7XG59XG5cbi8qKlxuICogVXRpbGl0eSBmdW5jdGlvbiB0byBjcmVhdGUgc3RhbmRhcmRpemVkIGVycm9yIHJlc3BvbnNlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVycm9yUmVzcG9uc2UoZXJyb3I6IEh0dHBFcnJvcik6IHtcbiAgZXJyb3I6IHtcbiAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgc3RhdHVzQ29kZTogbnVtYmVyO1xuICB9O1xufSB7XG4gIHJldHVybiB7XG4gICAgZXJyb3I6IHtcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICBzdGF0dXNDb2RlOiBlcnJvci5zdGF0dXNDb2RlLFxuICAgIH0sXG4gIH07XG59XG4iXX0=